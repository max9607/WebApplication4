@model WebApplication4.Models.TbTicket
@using WebApplication4.Controllers
@inject WebApplication4.Controllers.TbDerivadoesController oDerivados


@{
    
    ViewData["Title"] = "Details";
}

<h1>Detalles</h1>

<div>
    <h4>Ticket n°  @Html.DisplayFor(model => model.IdTicket)</h4>
    <hr />
    <div class="container">
        <div class="row">
            <div class="col">
                <dl class="row">

                    <dt class="col-sm-2">
                        Asunto
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.DespricionP)
                    </dd>
                    <dt class="col-sm-2">
                        Descripción
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.DescripionDetallada)
                    </dd>
                    <dt class="col-sm-2">
                        Localidad
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.Localizacion)
                    </dd>
                    <dt class="col-sm-2">
                        Adjunto
                    </dt>
                    <dd class="col-sm-10">
                        @if (Model.Adjunto != null)
                        {


                            <img src="@Url.Action("Obtener","TbTickets",new{id = Model.IdTicket} )" width="50px" height="50px">

                        }
                        else
                        {
                            <p>Ninguno</p>
                        }
                    </dd>
                    <dt class="col-sm-2">
                        Estado
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.IdEstadoNavigation.EstadoTicket)
                    </dd>
                    <dt class="col-sm-2">
                        Fecha
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.IdFechaNavigation.FechaCreado)
                    </dd>
                    <dt class="col-sm-2">
                        Prioridad
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.IdPrioridadNavigation.Prioridad)
                    </dd>
                    <dt class="col-sm-2">
                        Categoria
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.IdProblemaNavigation.Problema)
                    </dd>
                    <dt class="col-sm-2">
                        Usuario
                    </dt>
                    <dd class="col-sm-10">
                        @Html.DisplayFor(model => model.IdUsuarioNavigation.Nombre)
                        @Html.DisplayFor(model => model.IdUsuarioNavigation.Apellido1)
                        @Html.DisplayFor(model => model.IdUsuarioNavigation.Apellido2)
                    </dd>
                    <h5 style="padding-bottom:10px;">Opciones</h5>
                    
                    <hr />
                    <dd>
                        <a asp-action="Edit" asp-route-id="@Model?.IdTicket" class="btn btn-warning">Editar</a>
                        <a asp-action="Index" class="btn btn-secondary">Volver</a>
                    </dd>
                </dl>
            </div>
            <div class="col">
                
                @if (oDerivados.ExisteDerivado(Model.IdTicket)){
                    <label>Derivado a: </label> 
                    @oDerivados.NombreDerivado(Model.IdTicket)
                }
                <dl class="row">
                    <form asp-controller="TbDerivadoes" asp-action="Derivar" method="post">

                        <select class="form-control" asp-items="ViewBag.IdUsuario" id="Vuser" name="Vuser"></select>
                        <input type="text" class="btn btn-primary" id="Vticket" value="@Model.IdTicket" name="Vticket" hidden>
                        <input type="submit" class="btn btn-primary" value="Derivar">
                    </form>

                </dl>
            </div>
        </div>
    </div>


</div>

