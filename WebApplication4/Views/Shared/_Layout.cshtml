@using Microsoft.AspNetCore.Identity

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiceDesk</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/LayoutStyle.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/WebApplication4.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/icofont/icofont.min.css" asp-append-version="true">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.13.1/af-2.5.1/b-2.3.3/b-html5-2.3.3/b-print-2.3.3/date-1.2.0/fc-4.2.1/r-2.4.0/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/datatables.min.css"/>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    @RenderSection("Estilo", required: false) 

</head>

<body>
   @*  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                
                

            </div>
        </div>
     </nav> *@
    <div id="mainContent">
        <!-- Contenido principal de la página -->
        <button id="toggleButton" class="btn btn-primary">
            <i class="fas fa-bars"></i>
        </button>
    </div>
    <div id="sideMenu">
        <a class="navbar-brand" asp-controller="Home" asp-action="Index">
            <img src="/images/logo.jpg" width="30" height="30" class="d-inline-block align-top rounded" alt="">
            ISE Integrados
        </a>
        <!-- Contenido del menú -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">

            @if (User.IsInRole("Usuario"))
            {
                <li class="nav-item dropdown">
                    <a class="nav-link dropbtn" asp-controller="TbTickets" asp-action="UserTickets">
                        <i class="icofont-ticket text-light"></i>
                        Tickets
                    </a>

                    <ul class="submenu">
                        <li>
                            <a class="nav-link" asp-controller="TbTickets" asp-action="Create">
                                <i class="icofont-plus text-light"></i>
                                Nuevo
                            </a>
                        </li>
                    </ul>
                </li>
            }
            @if (User.IsInRole("Técnico"))
            {
                <li class="nav-item dropdown">
                    <a class="nav-link dropbtn" asp-controller="TbTickets" asp-action="Index">
                        <i class="icofont-ticket text-light"></i>
                        Tickets
                    </a>
                    <ul class="submenu">
                        <li>
                            <a class="nav-link" asp-controller="TbTickets" asp-action="Create">
                                <i class="icofont-plus text-light"></i>
                                Nuevo
                            </a>
                        </li>
                    </ul>
                </li>
            }
            @if (User.IsInRole("Administrador"))
            {
                <li class="nav-item">
                    <a class="nav-link" asp-controller="Home" asp-action="Index">
                        <i class="icofont-home text-light"></i>
                        Inicio
                    </a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropbtn" asp-controller="TbTickets" asp-action="Index">
                        <i class="icofont-ticket text-light"></i>
                        Tickets
                    </a>

                    <ul class="submenu">
                        <li>
                            <a class="nav-link" asp-controller="TbTickets" asp-action="Create">
                                <i class="icofont-plus text-light"></i>
                                Nuevo
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-controller="TbTickets" asp-action="BuscarTicket">
                                <i class="icofont-search-1 text-light"></i>
                                Buscar
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-controller="TbCategoriums" asp-action="Index">
                                <i class="icofont-tasks text-light"></i>
                                Categorías
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-controller="TbPrioridadTickets" asp-action="Index">
                                <i class="icofont-tasks text-light"></i>
                                Prioridad
                            </a>
                        </li>
                    </ul>
                </li>
            }
            @if (User.IsInRole("Administrador"))
            {
                <li class="nav-item dropdown">
                    <a class="nav-link dropbtn" asp-controller="TbUsuarios" asp-action="Index">
                        <i class="icofont-ui-user-group text-light"></i>
                        Usuarios
                    </a>
                    <ul class="submenu">
                        <li>
                            <a class="nav-link" asp-controller="TbUsuarios" asp-action="Create">
                                <i class="icofont-plus text-light"></i>
                                Nuevo
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-controller="TbEmpresas" asp-action="Index">
                                <i class="icofont-bag-alt text-light"></i>

                                Empresas
                            </a>
                        </li>
                        <li>
                            <a class="nav-link" asp-controller="TbAccesoes" asp-action="Index">
                                <i class="icofont-ui-password text-light"></i>
                                Accesos

                            </a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link" asp-controller="TbTicketsCerradoes" asp-action="Index">
                        <i class="icofont-file-document text-light"></i>
                        Reportes
                    </a>

                </li>

            }
        </ul>
        <ul class="navbar-nav justify-content-end mb-2 mb-lg-0">
            @if (User.FindFirst("IdUsuario") != null)
            {
                <li class="nav-item">
                    <a class="nav-link me-3" asp-controller="TbUsuarios" asp-action="Details" asp-route-id="@User.FindFirst("IdUsuario").Value">
                        <i class="icofont-ui-user text-light"></i>
                        @User.Identity.Name
                    </a>
                </li>
            }

            <li class="nav-item">
                <a class="btn btn-outline-light my-2 my-sm-0" asp-controller="Login" asp-action="Salir">Salir</a>
            </li>
        </ul>

        <div class="button-container">
            <button id="darkModeToggle" class="toggle-button">
                <span class="toggle-button-icon"></span>
            </button>
        </div>
        
    </div>
    <style>
        .button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 10vh; /* Esto es opcional, ajusta la altura según tus necesidades */
        }

        .toggle-button {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
            background-color: #ccc;
            border-radius: 10px;
            cursor: pointer;
        }

        .toggle-button-icon {
            position: absolute;
            top: 50%;
            left: 2px;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background-color: #fff;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .dark-mode .toggle-button-icon {
            transform: translateY(-50%) translateX(20px);
        }

        .toggle-button:hover .toggle-button-icon {
            background-color: #ddd;
        }

        .dark-mode .toggle-button {
            background-color: #333; /* Cambia el color de fondo en modo oscuro */
        }

        /* Estilo del icono de alternancia para el modo oscuro */
        .dark-mode .toggle-button-icon {
            background-color: #ddd; /* Cambia el color del icono en modo oscuro */
        }

        .dark-mode .card {
            background-color: #333; /* Cambia el color de fondo de las tarjetas */
            color: #ddd; /* Cambia el color del texto en las tarjetas */
        }
    </style>
     <div class="container justify-content-center">
            @RenderBody()

     </div>
    @*  <div class="collapse show" id="menu-content">
        @Html.Partial("_SideNav") <!-- Opcional: Puedes agregarlo donde desees que aparezca -->
        <div class="container">
        </div> *@


  @*   <footer class="border-top footer text-muted" style="padding-right">
        <div class="container">
            &copy; 2022 - ServiceDesk 
        </div>
    </footer> *@
    <script src="https://cdn.botpress.cloud/webchat/v1/inject.js"></script>
    <script>
        window.botpressWebChat.init({
            "composerPlaceholder": "Chat with bot",
            "botConversationDescription": "Este bot fue construido muy rapido con Botpress",
            "botId": "357917c8-0b55-48d4-921b-1cb9c7f79e7b",
            "hostUrl": "https://cdn.botpress.cloud/webchat/v1",
            "messagingUrl": "https://messaging.botpress.cloud",
            "clientId": "357917c8-0b55-48d4-921b-1cb9c7f79e7b",
            "webhookId": "dd83df8d-59ff-4462-b029-f1d3155c7db2",
            "lazySocket": true,
            "themeName": "prism",
            "frontendVersion": "v1",
            "showPoweredBy": true,
            "theme": "prism",
            "themeColor": "#2563eb"
        });
    </script>



    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.13.1/af-2.5.1/b-2.3.3/b-html5-2.3.3/b-print-2.3.3/date-1.2.0/fc-4.2.1/r-2.4.0/sc-2.0.7/sb-1.4.0/sp-2.1.0/sl-1.5.0/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.13.1/sorting/datetime-moment.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
<script>

    const toggleButton = document.getElementById('toggleButton');
    const sideMenu = document.getElementById('sideMenu');
    const mainContent = document.getElementById('mainContent');

    toggleButton.addEventListener('click', () => {
        if (sideMenu.style.width === '250px') {
            sideMenu.style.width = '0';
            mainContent.style.marginLeft = '0';
        } else {
            sideMenu.style.width = '250px';
            mainContent.style.marginLeft = '250px';
        }
    });
    const darkModeToggle = document.getElementById('darkModeToggle');

    darkModeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');

        // Guardar preferencia del usuario
        const isDarkMode = document.body.classList.contains('dark-mode');
        localStorage.setItem('darkMode', isDarkMode);
    });

    // Aplicar el modo oscuro si está configurado previamente
    const isDarkModeSet = localStorage.getItem('darkMode') === 'true';
    if (isDarkModeSet) {
        document.body.classList.add('dark-mode');
    }
</script>